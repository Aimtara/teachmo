{"version":3,"file":"AdminModerationQueue-Ce0omTc6.js","sources":["../../src/pages/AdminModerationQueue.jsx"],"sourcesContent":["import { useEffect, useState } from 'react';\nimport { MessagingModerationAPI } from '@/api/adapters';\n\nexport default function AdminModerationQueue() {\n  const [reports, setReports] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState('');\n  const [statusFilter, setStatusFilter] = useState('open');\n  const [actionState, setActionState] = useState({});\n\n  const loadReports = async () => {\n    setLoading(true);\n    try {\n      const list = await MessagingModerationAPI.listReports({ status: statusFilter });\n      setReports(Array.isArray(list) ? list : []);\n      setError('');\n    } catch (err) {\n      console.error(err);\n      setError(err?.message ?? 'Failed to load reports');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    loadReports();\n  }, [statusFilter]);\n\n  const triage = async (reportId, payload) => {\n    if (!reportId) return;\n    setActionState((prev) => ({ ...prev, [reportId]: true }));\n    try {\n      await MessagingModerationAPI.triageReport({ reportId, ...payload });\n      await loadReports();\n    } catch (err) {\n      console.error(err);\n      setError(err?.message ?? 'Unable to triage report');\n    } finally {\n      setActionState((prev) => ({ ...prev, [reportId]: false }));\n    }\n  };\n\n  return (\n    <div className=\"p-6 space-y-4\">\n      <div className=\"flex flex-col gap-3 md:flex-row md:items-center md:justify-between\">\n        <div>\n          <p className=\"text-sm text-gray-500\">Messaging moderation</p>\n          <h1 className=\"text-3xl font-semibold text-gray-900\">Message Reports</h1>\n          <p className=\"text-sm text-gray-600\">Review incoming reports and take action.</p>\n        </div>\n\n        <div className=\"flex flex-wrap gap-2\">\n          <select\n            value={statusFilter}\n            onChange={(e) => setStatusFilter(e.target.value)}\n            className=\"rounded-lg border border-gray-200 bg-white px-3 py-2 text-sm font-medium text-gray-800 shadow-sm\"\n          >\n            <option value=\"open\">Open</option>\n            <option value=\"triaged\">Triaged</option>\n            <option value=\"resolved\">Resolved</option>\n            <option value=\"dismissed\">Dismissed</option>\n          </select>\n          <button\n            type=\"button\"\n            onClick={loadReports}\n            className=\"rounded-lg border border-gray-200 bg-white px-3 py-2 text-sm font-medium text-gray-800 shadow-sm hover:bg-gray-50\"\n          >\n            Refresh\n          </button>\n        </div>\n      </div>\n\n      {error && (\n        <div className=\"rounded-lg border border-red-100 bg-red-50 p-4 text-sm text-red-700\" role=\"alert\">\n          {error}\n        </div>\n      )}\n\n      {loading ? (\n        <p className=\"text-gray-600\">Loading reportsâ€¦</p>\n      ) : reports.length === 0 ? (\n        <div className=\"rounded-lg border border-gray-100 bg-white p-6 shadow-sm\">\n          <p className=\"font-semibold text-gray-900\">No reports</p>\n          <p className=\"text-sm text-gray-600\">No reports match the selected status.</p>\n        </div>\n      ) : (\n        <div className=\"overflow-x-auto rounded-lg border border-gray-100 bg-white shadow-sm\">\n          <table className=\"min-w-full divide-y divide-gray-100\">\n            <thead className=\"bg-gray-50\">\n              <tr>\n                <th className=\"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wide text-gray-600\">Reason</th>\n                <th className=\"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wide text-gray-600\">Reporter</th>\n                <th className=\"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wide text-gray-600\">Status</th>\n                <th className=\"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wide text-gray-600\">Severity</th>\n                <th className=\"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wide text-gray-600\">Actions</th>\n              </tr>\n            </thead>\n            <tbody className=\"divide-y divide-gray-100\">\n              {reports.map((report) => (\n                <tr key={report.id}>\n                  <td className=\"px-4 py-3 text-sm text-gray-800\">\n                    <div className=\"font-semibold\">{report.reason || 'n/a'}</div>\n                    <div className=\"text-xs text-gray-500\">{report.detail || 'No details provided'}</div>\n                  </td>\n                  <td className=\"px-4 py-3 text-sm text-gray-800\">{report.reporter_user_id || 'Unknown'}</td>\n                  <td className=\"px-4 py-3 text-sm text-gray-800\">{report.status}</td>\n                  <td className=\"px-4 py-3 text-sm text-gray-800 capitalize\">{report.severity}</td>\n                  <td className=\"px-4 py-3 text-sm text-gray-800\">\n                    <div className=\"flex flex-wrap gap-2\">\n                      <button\n                        type=\"button\"\n                        disabled={actionState[report.id]}\n                        onClick={() => triage(report.id, { status: 'triaged', severity: 'medium', action: 'none' })}\n                        className=\"rounded border border-amber-200 bg-amber-50 px-3 py-1 text-xs font-semibold text-amber-800 hover:bg-amber-100 disabled:opacity-60\"\n                      >\n                        Triage\n                      </button>\n                      <button\n                        type=\"button\"\n                        disabled={actionState[report.id]}\n                        onClick={() => triage(report.id, { status: 'resolved', severity: 'low', action: 'close_thread' })}\n                        className=\"rounded border border-emerald-200 bg-emerald-50 px-3 py-1 text-xs font-semibold text-emerald-800 hover:bg-emerald-100 disabled:opacity-60\"\n                      >\n                        Resolve &amp; close\n                      </button>\n                      <button\n                        type=\"button\"\n                        disabled={actionState[report.id]}\n                        onClick={() => triage(report.id, { status: 'dismissed', severity: 'low', action: 'none' })}\n                        className=\"rounded border border-gray-200 bg-gray-50 px-3 py-1 text-xs font-semibold text-gray-800 hover:bg-gray-100 disabled:opacity-60\"\n                      >\n                        Dismiss\n                      </button>\n                    </div>\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":["AdminModerationQueue","reports","setReports","useState","loading","setLoading","error","setError","statusFilter","setStatusFilter","actionState","setActionState","loadReports","list","MessagingModerationAPI.listReports","err","useEffect","triage","reportId","payload","prev","MessagingModerationAPI.triageReport","jsxs","jsx","e","report"],"mappings":"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"}
import{o as p,q as g,r as o,j as e,L as j,w as h}from"./index-CcbYISPP.js";function f(r){try{return new Date(r).toLocaleDateString(void 0,{weekday:"short",month:"short",day:"numeric"})}catch{return r}}function N(){const{id:r}=p(),d=g(),[c,m]=o.useState(!0),[n,x]=o.useState(""),[a,u]=o.useState(null);o.useEffect(()=>{let t=!0;return(async()=>{if(!r){d("/parent/dashboard",{replace:!0});return}m(!0),x("");try{const l=await h.get(r);if(!t)return;u(l),h.logView(r,"dashboard").catch(()=>{})}catch(l){if(!t)return;x((l==null?void 0:l.message)||"Unable to load weekly brief")}finally{if(!t)return;m(!1)}})(),()=>{t=!1}},[r,d]);const s=a==null?void 0:a.brief_content;return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("header",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold",children:(s==null?void 0:s.title)||"This Week at School"}),e.jsx("p",{className:"text-gray-600",children:s!=null&&s.weekOf?`Week of ${f(s.weekOf)}`:""})]}),e.jsx(j,{to:"/parent/dashboard",className:"text-sm font-medium text-indigo-600 hover:text-indigo-700",children:"Back to dashboard"})]}),c&&e.jsx("p",{className:"text-gray-600",children:"Loading…"}),!c&&n&&e.jsx("p",{className:"text-red-600",children:n}),!c&&!n&&a&&e.jsxs("div",{className:"bg-white shadow rounded p-6 space-y-6",children:[e.jsxs("section",{children:[e.jsx("h2",{className:"text-sm font-semibold text-gray-700 uppercase tracking-wide",children:"What matters most"}),e.jsxs("ul",{className:"mt-3 space-y-3",children:[((s==null?void 0:s.whatMattersMost)||[]).map((t,i)=>e.jsxs("li",{className:"border-b pb-3 last:border-0 last:pb-0",children:[e.jsx("p",{className:"font-semibold",children:t.text}),e.jsxs("p",{className:"text-sm text-gray-600",children:[t.etaMinutes?`~${t.etaMinutes} min`:null,t.etaMinutes&&t.why?" · ":null,t.why||null]})]},`${a.id}-core-${i}`)),((s==null?void 0:s.whatMattersMost)||[]).length===0&&e.jsx("li",{className:"text-gray-500",children:"No core items detected for this week."})]})]}),((s==null?void 0:s.goodToKnow)||[]).length>0&&e.jsxs("section",{children:[e.jsx("h2",{className:"text-sm font-semibold text-gray-700 uppercase tracking-wide",children:"Good to know"}),e.jsx("ul",{className:"mt-3 space-y-2 text-sm text-gray-700",children:(s.goodToKnow||[]).map((t,i)=>e.jsxs("li",{children:["• ",t.text]},`${a.id}-gtk-${i}`))})]}),a.mediation_level!=="HIGH"&&((s==null?void 0:s.optionalIfYouHaveTime)||[]).length>0&&e.jsxs("section",{children:[e.jsx("h2",{className:"text-sm font-semibold text-gray-700 uppercase tracking-wide",children:"Optional if you have time"}),e.jsx("ul",{className:"mt-3 space-y-2 text-sm text-gray-700",children:(s.optionalIfYouHaveTime||[]).map((t,i)=>e.jsxs("li",{children:["• ",t.text]},`${a.id}-opt-${i}`))})]}),s!=null&&s.teachmoNote?e.jsx("section",{className:"bg-gray-50 rounded p-4",children:e.jsx("p",{className:"text-sm text-gray-700 italic",children:s.teachmoNote})}):null,e.jsx("section",{className:"pt-2 border-t",children:e.jsxs("details",{children:[e.jsx("summary",{className:"cursor-pointer text-sm font-medium text-gray-700",children:"Technical details (for debugging)"}),e.jsxs("div",{className:"mt-3 text-sm text-gray-600 space-y-1",children:[e.jsxs("p",{children:["Mediation: ",e.jsx("span",{className:"font-mono",children:a.mediation_level})]}),e.jsxs("p",{children:["SLS / HCS / TI:"," ",e.jsxs("span",{className:"font-mono",children:[a.school_load_score," / ",a.home_capacity_score," / ",a.tension_index]})]}),e.jsxs("p",{children:["Views: ",e.jsx("span",{className:"font-mono",children:a.view_count})]})]})]})})]})]})}export{N as default};
//# sourceMappingURL=WeeklyBriefDetail-CRi0UeWL.js.map

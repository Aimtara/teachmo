import{c as L,r as i,j as e,B as g,ad as _,e as S,z as v,J as U,h as D,C as b,i as I,k,m as T,o as P,al as F,am as B}from"./index-BPP-_OMN.js";import{I as o}from"./input-DXyqFpUo.js";import{L as d}from"./label-BYGjLjtR.js";import{T as K,a as M,b as w,c as N}from"./tabs-CMvz8dI1.js";import{B as V}from"./badge-BdaYTYbY.js";import{E as z}from"./external-link-B--24W3a.js";import{C as q}from"./check-BnYO2CVa.js";import{L as O}from"./loader-circle-CPuSJKcI.js";import{S as H}from"./server-CnecnCWM.js";import"./cn-2dOUpm6k.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],W=L("Database",J);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],X=L("Globe",G);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],Q=L("Key",Y),A=U("ServiceConnect");function R({serviceKey:n,serviceName:r,icon:m,connected:u=!1}){const[x,t]=i.useState(!1),[c,p]=i.useState(u),a=i.useRef(null);i.useEffect(()=>()=>{a.current&&(window.clearInterval(a.current),a.current=null)},[]);const y=async()=>{t(!0);try{const l=await fetch(`${S}/integrations/${n}/auth`,{method:"POST"}),h=l.ok?await l.json():{authUrl:`https://${n}.com/login?mock=true`},j=600,s=700,$=window.screenX+(window.outerWidth-j)/2,E=window.screenY+(window.outerHeight-s)/2,C=window.open(h.authUrl,`Connect ${r}`,`width=${j},height=${s},left=${$},top=${E}`);a.current&&window.clearInterval(a.current),a.current=window.setInterval(()=>{C!=null&&C.closed&&(window.clearInterval(a.current),a.current=null,t(!1),p(!0),v(`Connected to ${r}!`))},500)}catch(l){A.error(l),t(!1),v("Connection failed. Please try again.","error")}},f=async()=>{if(window.confirm(`Disconnect ${r}?`)){t(!0);try{if(!(await fetch(`${S}/integrations/${n}/disconnect`,{method:"POST",headers:{"Content-Type":"application/json"}})).ok)throw new Error("Failed to disconnect service");p(!1),v(`Disconnected ${r}`)}catch(h){A.error(h),v(`Failed to disconnect ${r}. Please try again.`,"error")}finally{t(!1)}}};return e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg bg-white shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`p-2 rounded-full ${c?"bg-green-100":"bg-gray-100"}`,children:m?e.jsx(m,{className:`w-6 h-6 ${c?"text-green-600":"text-gray-500"}`}):e.jsx(z,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:r}),e.jsx("p",{className:"text-xs text-gray-500",children:c?"Sync active":"Not connected"})]})]}),e.jsx("div",{className:"flex items-center gap-3",children:c?e.jsxs(e.Fragment,{children:[e.jsxs(V,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200",children:[e.jsx(q,{className:"w-3 h-3 mr-1"})," Connected"]}),e.jsx(g,{variant:"ghost",size:"sm",onClick:f,className:"text-red-500 hover:text-red-700 hover:bg-red-50",children:e.jsx(_,{className:"w-4 h-4"})})]}):e.jsxs(g,{onClick:y,disabled:x,size:"sm",children:[x?e.jsx(O,{className:"w-4 h-4 animate-spin mr-2"}):null,"Connect"]})})]})}function oe(){const{toast:n}=D(),[r,m]=i.useState(""),[u,x]=i.useState(""),[t,c]=i.useState(""),[p,a]=i.useState(""),[y,f]=i.useState(""),l=()=>{if(!r.trim()||!u.trim()){n({title:"Validation Error",description:"Platform Issuer and Client ID are required.",variant:"destructive"});return}console.log("Saving LTI platform configuration",{issuer:r,clientId:u}),n({title:"Configuration Saved",description:"LTI platform configuration has been saved successfully."}),m(""),x("")},h=()=>{if(!t.trim()){n({title:"Validation Error",description:"LRS Endpoint is required.",variant:"destructive"});return}console.log("Saving LRS configuration",{endpoint:t,username:p}),n({title:"Configuration Saved",description:"LRS configuration has been saved successfully."}),c(""),a(""),f("")},j=()=>{if(!t.trim()){n({title:"Validation Error",description:"LRS Endpoint is required to test connection.",variant:"destructive"});return}console.log("Testing LRS connection",{endpoint:t}),n({title:"Feature Not Implemented",description:"Connection testing will be available once the backend endpoint is implemented.",variant:"destructive"})};return e.jsxs("div",{className:"p-6 max-w-6xl mx-auto space-y-8",children:[e.jsxs("header",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Integrations & Data"}),e.jsx("p",{className:"text-gray-600",children:"Configure LTI providers, xAPI stores, and third-party content services."})]}),e.jsxs(K,{defaultValue:"lti",className:"w-full",children:[e.jsxs(M,{children:[e.jsx(w,{value:"lti",children:"LTI Tool Providers"}),e.jsx(w,{value:"xapi",children:"xAPI (LRS)"}),e.jsx(w,{value:"services",children:"Content Services"})]}),e.jsx(N,{value:"lti",className:"space-y-6 mt-6",children:e.jsxs(b,{children:[e.jsxs(I,{children:[e.jsxs(k,{className:"flex items-center gap-2",children:[e.jsx(Q,{className:"w-5 h-5"})," LTI 1.3 Configuration"]}),e.jsx(T,{children:"Add Teachmo as a tool in Canvas, Schoology, or Blackboard."})]}),e.jsxs(P,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Tool Launch URL"}),e.jsx(o,{readOnly:!0,value:F,className:"bg-gray-50"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Public JWKS URL"}),e.jsx(o,{readOnly:!0,value:B,className:"bg-gray-50"})]})]}),e.jsxs("div",{className:"pt-4 border-t",children:[e.jsx("h4",{className:"font-medium mb-4",children:"Register New Platform"}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"lti-platform-issuer",children:"Platform Issuer (ISS)"}),e.jsx(o,{id:"lti-platform-issuer",placeholder:"https://canvas.instructure.com",value:r,onChange:s=>m(s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"lti-client-id",children:"Client ID"}),e.jsx(o,{id:"lti-client-id",placeholder:"10000000000001",value:u,onChange:s=>x(s.target.value)})]})]}),e.jsx(g,{className:"mt-4",onClick:l,children:"Save Platform Configuration"})]})]})]})}),e.jsx(N,{value:"xapi",className:"space-y-6 mt-6",children:e.jsxs(b,{children:[e.jsxs(I,{children:[e.jsxs(k,{className:"flex items-center gap-2",children:[e.jsx(W,{className:"w-5 h-5"})," Learning Record Store (LRS)"]}),e.jsx(T,{children:"Configure where xAPI statements for student activities should be sent."})]}),e.jsxs(P,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"lrs-endpoint",children:"LRS Endpoint"}),e.jsx(o,{id:"lrs-endpoint",placeholder:"https://lrs.io/xapi/statements",value:t,onChange:s=>c(s.target.value)})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"lrs-auth-username",children:"Auth Key / Username"}),e.jsx(o,{id:"lrs-auth-username",placeholder:"Basic Auth Username",value:p,onChange:s=>a(s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"lrs-auth-password",children:"Auth Secret / Password"}),e.jsx(o,{id:"lrs-auth-password",type:"password",placeholder:"••••••••••••",value:y,onChange:s=>f(s.target.value)})]})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(g,{onClick:h,children:"Save Configuration"}),e.jsx(g,{variant:"outline",onClick:j,children:"Test Connection"})]})]})]})}),e.jsxs(N,{value:"services",className:"space-y-4 mt-6",children:[e.jsx(R,{serviceKey:"khan_academy",serviceName:"Khan Academy",icon:X}),e.jsx(R,{serviceKey:"clever",serviceName:"Clever (District)",icon:H,connected:!0})]})]})]})}export{oe as default};
//# sourceMappingURL=AdminLMSIntegration-GXhPPvrJ.js.map

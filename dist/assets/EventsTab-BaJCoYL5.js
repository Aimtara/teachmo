import{c as y,av as C,r as n,j as e,a9 as E,C as M,i as S,k as T,o as L,B as N,O as p}from"./index-CXW08ga6.js";import{U as $,c as A,L as z,d as D}from"./entities-CLCXHT4z.js";import"./messaging-cshogndc.js";import{S as F,u as I,a as P}from"./useDebounce-ABn6640d.js";import{I as B}from"./input-DQ0nv64R.js";import{L as U,E as V,a as W}from"./LoadingStates-vF0mXKmr.js";import{B as h}from"./badge-Dl3t65au.js";import{U as q}from"./users-CCMiawQ7.js";import{S as H}from"./sparkles-BjNBUl13.js";import{C as R}from"./calendar-DD8JTmH3.js";import{C as O}from"./clock-Bt1pb8u7.js";import{T as Y,C as G}from"./target-kZPmE_ex.js";import{E as J}from"./external-link-Duz6MPfX.js";import{i as _,a as K,p as j}from"./parseISO-BL2JKQ2d.js";import{c as b}from"./constructNow-Dsgkv_Lg.js";import{S as Q}from"./switch-4n8ahTqY.js";import{L as X}from"./label-C454ix-G.js";import{S as w}from"./Discover-D4rWGRi3.js";import"./skeleton-Tb_I7mPl.js";import"./alert-KdgI_V-I.js";import"./circle-alert-CzGZOM4y.js";import"./loader-circle-fFoU9KsL.js";import"./chevron-right-CPiZDxOX.js";import"./tabs-D--5WbS4.js";import"./cn-2dOUpm6k.js";import"./book-open-Bot6lLRm.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]],ee=y("List",Z);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],ae=y("MapPin",se);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],re=y("Map",te);function ie(s,r){return C(s,b(s),r)}function le(s){return _(s,b(s))}function oe(s){return _(s,K(b(s),1))}const ne={creative:"bg-purple-100 text-purple-800 border-purple-200",educational:"bg-blue-100 text-blue-800 border-blue-200",physical:"bg-green-100 text-green-800 border-green-200",social:"bg-pink-100 text-pink-800 border-pink-200",emotional:"bg-indigo-100 text-indigo-800 border-indigo-200",music:"bg-yellow-100 text-yellow-800 border-yellow-200",outdoor:"bg-emerald-100 text-emerald-800 border-emerald-200",science:"bg-cyan-100 text-cyan-800 border-cyan-200",art:"bg-red-100 text-red-800 border-red-200"};function ce({event:s,child:r,showRelevanceScore:u=!1}){const[l,c]=n.useState(!1),o=t=>{if(!t)return"";try{const a=j(t);return le(a)?"Today":oe(a)?"Tomorrow":ie(a)?p(a,"EEEE"):p(a,"MMM d")}catch{return""}},d=(t,a)=>{if(!t)return"";try{const m=j(t);let x=p(m,"h:mm a");if(a){const f=j(a);x+=` - ${p(f,"h:mm a")}`}return x}catch{return""}},g=async()=>{c(!0);try{const t=await $.me();await A.create({title:s.title,description:`${s.description}

Source: ${s.source}${s.teachmo_tip?`

Teachmo Tip: ${s.teachmo_tip}`:""}`,start_time:s.start_time,end_time:s.end_time||s.start_time,location:`${s.location_name}${s.address?`, ${s.address}`:""}`,resource_type:"event",resource_id:s.id,user_id:t.id,child_id:r==null?void 0:r.id,color:"#e74c3c"});const a=document.getElementById(`add-calendar-${s.id}`);a&&(a.textContent="âœ“ Added!",setTimeout(()=>{a.innerHTML='<span class="flex items-center gap-2"><CalendarPlus class="w-4 h-4" />Add to Calendar</span>'},2e3))}catch(t){console.error("Failed to add event to calendar:",t)}c(!1)},i=t=>t>=80?"text-green-600":t>=60?"text-yellow-600":"text-gray-600";return e.jsx(E.div,{whileHover:{y:-2,transition:{duration:.2}},className:"h-full",children:e.jsxs(M,{className:"h-full flex flex-col border-0 shadow-lg hover:shadow-xl transition-all duration-300 bg-white/90 backdrop-blur-sm",children:[e.jsx(S,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(T,{className:"text-lg font-bold text-gray-900 line-clamp-2 mb-2",children:s.title}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-3",children:[s.category&&e.jsx(h,{className:ne[s.category]||"bg-gray-100 text-gray-800",children:s.category}),s.is_free?e.jsx(h,{className:"bg-green-100 text-green-800 border-green-200",children:"Free"}):e.jsx(h,{className:"bg-orange-100 text-orange-800 border-orange-200",children:s.price_display||"Paid"}),s.age_group&&e.jsxs(h,{variant:"outline",className:"text-xs",children:[e.jsx(q,{className:"w-3 h-3 mr-1"}),s.age_group]})]})]}),u&&s.relevance_score&&e.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[e.jsx(F,{className:`w-4 h-4 ${i(s.relevance_score)}`}),e.jsxs("span",{className:i(s.relevance_score),children:[s.relevance_score,"%"]})]})]})}),e.jsxs(L,{className:"flex-1 flex flex-col justify-between space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-600 line-clamp-3 flex-1",children:s.description}),s.teachmo_tip&&e.jsx("div",{className:"p-3 bg-blue-50 rounded-lg border-l-4 border-blue-400",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(H,{className:"w-4 h-4 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-xs font-semibold text-blue-800 mb-1",children:["Why This Is Perfect for ",(r==null?void 0:r.name)||"Your Child"]}),e.jsx("p",{className:"text-xs text-blue-700 leading-relaxed",children:s.teachmo_tip})]})]})}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(R,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{className:"font-medium",children:o(s.start_time)}),s.start_time&&e.jsxs(e.Fragment,{children:[e.jsx(O,{className:"w-4 h-4 flex-shrink-0 ml-2"}),e.jsx("span",{children:d(s.start_time,s.end_time)})]})]}),s.location_name&&e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ae,{className:"w-4 h-4 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:s.location_name}),s.address&&e.jsx("p",{className:"text-xs text-gray-500 line-clamp-1",children:s.address})]})]}),s.learning_objectives&&s.learning_objectives.length>0&&e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Y,{className:"w-4 h-4 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-xs",children:[e.jsx("span",{className:"font-medium",children:"Skills: "}),s.learning_objectives.slice(0,2).join(", "),s.learning_objectives.length>2&&"..."]})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-3 border-t border-gray-100",children:[e.jsxs("div",{className:"text-xs text-gray-500",children:["via ",s.source]}),e.jsxs("div",{className:"flex gap-2",children:[s.url&&e.jsxs(N,{size:"sm",variant:"outline",className:"text-xs",onClick:()=>window.open(s.url,"_blank"),children:[e.jsx(J,{className:"w-3 h-3 mr-1"}),"Details"]}),e.jsx(N,{id:`add-calendar-${s.id}`,size:"sm",onClick:g,disabled:l,style:{backgroundColor:"var(--teachmo-sage)"},className:"text-xs",children:l?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-3 h-3 border-2 border-white border-t-transparent rounded-full animate-spin mr-1"}),"Adding..."]}):e.jsxs(e.Fragment,{children:[e.jsx(G,{className:"w-3 h-3 mr-1"}),"Add"]})})]})]})]})]})})}const de=()=>e.jsx("div",{className:"h-96 w-full bg-gray-200 rounded-lg flex items-center justify-center",children:e.jsx("p",{className:"text-gray-500",children:"Map view is coming soon!"})});function Ie({initialQuery:s}){const[r,u]=n.useState([]),[l,c]=n.useState(s),o=I(l,300),[d,g]=n.useState("list"),i=P({context:"events"});n.useEffect(()=>{t()},[o]);const t=async()=>{const a={...o&&{title:{$ilike:`%${o}%`}}},m=await i.execute(async()=>{const x=await z.filter(a,"-start_time",25),f=await D.filter({...a,status:"published"},"-start_time",25);return[...x,...f].sort((k,v)=>new Date(v.start_time)-new Date(k.start_time))},{key:"events",errorContext:"loading events"});m&&u(m)};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"sticky top-0 z-10 bg-inherit py-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 justify-between items-center",children:[e.jsxs("div",{className:"relative flex-grow w-full",children:[e.jsx(w,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-500"}),e.jsx(B,{placeholder:"Search events by name or location...",className:"pl-9",value:l,onChange:a=>c(a.target.value)})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ee,{className:"w-5 h-5"}),e.jsx(Q,{checked:d==="map",onCheckedChange:a=>g(a?"map":"list"),id:"map-view-toggle"}),e.jsx(re,{className:"w-5 h-5"}),e.jsx(X,{htmlFor:"map-view-toggle",className:"sr-only",children:"Toggle Map View"})]})]})}),d==="map"?e.jsx(de,{events:r}):i.isLoading("events")?e.jsx(U,{items:4,cardType:"event"}):i.hasError("events")?e.jsx(V,{error:i.getError("events"),onRetry:t}):r.length===0?e.jsx(W,{icon:w,title:"No Events Found",description:"We couldn't find any events matching your search. Try a different keyword."}):e.jsx("div",{className:"space-y-4",children:r.map(a=>e.jsx(ce,{event:a},a.id))})]})}export{Ie as EventsTab,Ie as default};
//# sourceMappingURL=EventsTab-BaJCoYL5.js.map

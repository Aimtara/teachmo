{"version":3,"file":"AdminNotifications-BHzbBAwq.js","sources":["../../src/pages/AdminNotifications.jsx"],"sourcesContent":["import { useMemo, useState } from 'react';\nimport { useMutation, useQuery } from '@tanstack/react-query';\nimport { API_BASE_URL } from '@/config/api';\nimport { nhost } from '@/lib/nhostClient';\nimport { useToast } from '@/components/ui/use-toast';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Checkbox } from '@/components/ui/checkbox';\nimport { Label } from '@/components/ui/label';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { Switch } from '@/components/ui/switch';\n\nconst ROLE_OPTIONS = [\n  { value: 'parent', label: 'Parents' },\n  { value: 'teacher', label: 'Teachers' },\n  { value: 'school_admin', label: 'School admins' },\n  { value: 'district_admin', label: 'District admins' },\n  { value: 'system_admin', label: 'System admins' },\n];\n\nasync function fetchJson(url, opts = {}) {\n  const response = await fetch(url, opts);\n  if (!response.ok) {\n    const text = await response.text();\n    throw new Error(text || 'Request failed');\n  }\n  return response.json();\n}\n\nfunction normalizeCsv(value) {\n  return value\n    .split(',')\n    .map((item) => item.trim())\n    .filter(Boolean);\n}\n\nexport default function AdminNotifications() {\n  const { toast } = useToast();\n  const [channel, setChannel] = useState('email');\n  const [title, setTitle] = useState('');\n  const [body, setBody] = useState('');\n  const [sendAt, setSendAt] = useState('');\n  const [userIds, setUserIds] = useState('');\n  const [schoolIds, setSchoolIds] = useState('');\n  const [selectedRoles, setSelectedRoles] = useState(new Set(['parent', 'teacher']));\n\n  const headersQuery = useQuery({\n    queryKey: ['notification_headers'],\n    queryFn: async () => {\n      const token = await nhost.auth.getAccessToken();\n      return {\n        'Content-Type': 'application/json',\n        ...(token ? { Authorization: `Bearer ${token}` } : {}),\n      };\n    },\n  });\n\n  const announcementsQuery = useQuery({\n    queryKey: ['admin_announcements'],\n    queryFn: async () => fetchJson(`${API_BASE_URL}/admin/notifications/announcements`, { headers: headersQuery.data }),\n  });\n\n  const metricsQuery = useQuery({\n    queryKey: ['admin_notification_metrics', channel],\n    queryFn: async () =>\n      fetchJson(`${API_BASE_URL}/admin/notifications/metrics?channel=${channel}`, { headers: headersQuery.data }),\n  });\n\n  const tenantSettingsQuery = useQuery({\n    queryKey: ['admin_notification_settings'],\n    queryFn: async () => fetchJson(`${API_BASE_URL}/tenants/settings`, { headers: headersQuery.data }),\n  });\n\n  const notificationSettings = useMemo(() => {\n    const settings = tenantSettingsQuery.data?.settings?.settings || {};\n    return settings.notifications || {};\n  }, [tenantSettingsQuery.data]);\n\n  const toggleRole = (value) => {\n    setSelectedRoles((prev) => {\n      const next = new Set(prev);\n      if (next.has(value)) {\n        next.delete(value);\n      } else {\n        next.add(value);\n      }\n      return next;\n    });\n  };\n\n  const createMutation = useMutation({\n    mutationFn: async () => {\n      const payload = {\n        channel,\n        title,\n        body,\n        send_at: sendAt ? new Date(sendAt).toISOString() : null,\n        segment: {\n          roles: Array.from(selectedRoles),\n          user_ids: normalizeCsv(userIds),\n          school_ids: normalizeCsv(schoolIds),\n        },\n      };\n      return fetchJson(`${API_BASE_URL}/admin/notifications/announcements`, {\n        method: 'POST',\n        headers: headersQuery.data,\n        body: JSON.stringify(payload),\n      });\n    },\n    onSuccess: () => {\n      toast({\n        title: 'Announcement queued',\n        description: 'Your notification is now in the delivery queue.',\n      });\n      setTitle('');\n      setBody('');\n      setSendAt('');\n      announcementsQuery.refetch();\n    },\n    onError: (error) => {\n      toast({\n        variant: 'destructive',\n        title: 'Unable to send',\n        description: error instanceof Error ? error.message : 'Failed to create announcement.',\n      });\n    },\n  });\n\n  const settingsMutation = useMutation({\n    mutationFn: async (nextSettings) => {\n      const current = tenantSettingsQuery.data?.settings || {};\n      return fetchJson(`${API_BASE_URL}/tenants/settings`, {\n        method: 'PUT',\n        headers: headersQuery.data,\n        body: JSON.stringify({\n          branding: current.branding || {},\n          settings: {\n            ...(current.settings || {}),\n            notifications: nextSettings,\n          },\n        }),\n      });\n    },\n    onSuccess: () => {\n      toast({\n        title: 'Deliverability settings saved',\n        description: 'Tenant validation settings are updated.',\n      });\n      tenantSettingsQuery.refetch();\n    },\n    onError: (error) => {\n      toast({\n        variant: 'destructive',\n        title: 'Save failed',\n        description: error instanceof Error ? error.message : 'Unable to update settings.',\n      });\n    },\n  });\n\n  const metrics = metricsQuery.data?.metrics || {};\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div>\n        <h1 className=\"text-2xl font-semibold\">Notifications</h1>\n        <p className=\"text-sm text-muted-foreground\">\n          Queue tenant-wide or segmented announcements and monitor deliverability signals.\n        </p>\n      </div>\n\n      <Card>\n        <CardHeader>\n          <CardTitle>Deliverability Settings</CardTitle>\n        </CardHeader>\n        <CardContent className=\"space-y-4 text-sm\">\n          <div className=\"grid gap-4 md:grid-cols-2\">\n            <div className=\"space-y-3\">\n              <div className=\"flex items-center justify-between\">\n                <Label htmlFor=\"spf-toggle\">SPF validated</Label>\n                <Switch\n                  id=\"spf-toggle\"\n                  checked={notificationSettings.email?.spf === 'pass'}\n                  onCheckedChange={(checked) =>\n                    settingsMutation.mutate({\n                      ...notificationSettings,\n                      email: { ...notificationSettings.email, spf: checked ? 'pass' : 'fail' },\n                    })\n                  }\n                />\n              </div>\n              <div className=\"flex items-center justify-between\">\n                <Label htmlFor=\"dkim-toggle\">DKIM validated</Label>\n                <Switch\n                  id=\"dkim-toggle\"\n                  checked={notificationSettings.email?.dkim === 'pass'}\n                  onCheckedChange={(checked) =>\n                    settingsMutation.mutate({\n                      ...notificationSettings,\n                      email: { ...notificationSettings.email, dkim: checked ? 'pass' : 'fail' },\n                    })\n                  }\n                />\n              </div>\n              <div className=\"flex items-center justify-between\">\n                <Label htmlFor=\"dmarc-toggle\">DMARC validated</Label>\n                <Switch\n                  id=\"dmarc-toggle\"\n                  checked={notificationSettings.email?.dmarc === 'pass'}\n                  onCheckedChange={(checked) =>\n                    settingsMutation.mutate({\n                      ...notificationSettings,\n                      email: { ...notificationSettings.email, dmarc: checked ? 'pass' : 'fail' },\n                    })\n                  }\n                />\n              </div>\n            </div>\n            <div className=\"space-y-3\">\n              <div className=\"flex items-center justify-between\">\n                <Label htmlFor=\"sms-toggle\">SMS opt-in enabled</Label>\n                <Switch\n                  id=\"sms-toggle\"\n                  checked={notificationSettings.sms?.opt_in === true}\n                  onCheckedChange={(checked) =>\n                    settingsMutation.mutate({\n                      ...notificationSettings,\n                      sms: { ...notificationSettings.sms, opt_in: checked },\n                    })\n                  }\n                />\n              </div>\n              <p className=\"text-xs text-muted-foreground\">\n                SPF/DKIM/DMARC must pass to send email; SMS opt-in is required for SMS delivery.\n              </p>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      <Card>\n        <CardHeader>\n          <CardTitle>Announcement Composer</CardTitle>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"grid gap-4 md:grid-cols-2\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"announcement-title\">Title</Label>\n              <Input\n                id=\"announcement-title\"\n                value={title}\n                onChange={(event) => setTitle(event.target.value)}\n                placeholder=\"Quarterly update\"\n              />\n            </div>\n            <div className=\"space-y-2\">\n              <Label>Channel</Label>\n              <Select value={channel} onValueChange={setChannel}>\n                <SelectTrigger>\n                  <SelectValue placeholder=\"Select channel\" />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"email\">Email</SelectItem>\n                  <SelectItem value=\"sms\">SMS</SelectItem>\n                  <SelectItem value=\"push\">Push</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"announcement-body\">Message</Label>\n            <Textarea\n              id=\"announcement-body\"\n              value={body}\n              onChange={(event) => setBody(event.target.value)}\n              rows={4}\n              placeholder=\"Share an update with your community...\"\n            />\n          </div>\n\n          <div className=\"grid gap-4 md:grid-cols-2\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"announcement-sendat\">Scheduled send time</Label>\n              <Input\n                id=\"announcement-sendat\"\n                type=\"datetime-local\"\n                value={sendAt}\n                onChange={(event) => setSendAt(event.target.value)}\n              />\n            </div>\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"announcement-school\">School IDs (optional)</Label>\n              <Input\n                id=\"announcement-school\"\n                value={schoolIds}\n                onChange={(event) => setSchoolIds(event.target.value)}\n                placeholder=\"uuid, uuid\"\n              />\n            </div>\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label>Target roles</Label>\n            <div className=\"grid gap-2 sm:grid-cols-2 lg:grid-cols-3\">\n              {ROLE_OPTIONS.map((role) => (\n                <label key={role.value} className=\"flex items-center gap-2 text-sm\">\n                  <Checkbox\n                    checked={selectedRoles.has(role.value)}\n                    onCheckedChange={() => toggleRole(role.value)}\n                  />\n                  {role.label}\n                </label>\n              ))}\n            </div>\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"announcement-users\">Specific user IDs (optional)</Label>\n            <Textarea\n              id=\"announcement-users\"\n              value={userIds}\n              onChange={(event) => setUserIds(event.target.value)}\n              rows={2}\n              placeholder=\"uuid, uuid\"\n            />\n          </div>\n\n          <Button onClick={() => createMutation.mutate()} disabled={createMutation.isPending}>\n            Queue announcement\n          </Button>\n        </CardContent>\n      </Card>\n\n      <Card>\n        <CardHeader>\n          <CardTitle>Deliverability Metrics</CardTitle>\n        </CardHeader>\n        <CardContent className=\"grid gap-4 md:grid-cols-4 text-sm\">\n          <div>\n            <div className=\"text-muted-foreground\">Delivered</div>\n            <div className=\"text-lg font-semibold\">{metrics.delivered || 0}</div>\n          </div>\n          <div>\n            <div className=\"text-muted-foreground\">Bounced</div>\n            <div className=\"text-lg font-semibold\">{metrics.bounced || 0}</div>\n          </div>\n          <div>\n            <div className=\"text-muted-foreground\">Opened</div>\n            <div className=\"text-lg font-semibold\">{metrics.opened || 0}</div>\n          </div>\n          <div>\n            <div className=\"text-muted-foreground\">Clicked</div>\n            <div className=\"text-lg font-semibold\">{metrics.clicked || 0}</div>\n          </div>\n        </CardContent>\n      </Card>\n\n      <Card>\n        <CardHeader>\n          <CardTitle>Recent Announcements</CardTitle>\n        </CardHeader>\n        <CardContent className=\"space-y-4 text-sm\">\n          {(announcementsQuery.data?.announcements || []).map((announcement) => (\n            <div key={announcement.id} className=\"border rounded-md p-4 space-y-1\">\n              <div className=\"flex items-center justify-between\">\n                <div className=\"font-semibold\">{announcement.title || 'Untitled announcement'}</div>\n                <div className=\"text-xs uppercase text-muted-foreground\">{announcement.status}</div>\n              </div>\n              <div className=\"text-xs text-muted-foreground\">\n                {announcement.channel} • scheduled {announcement.send_at ? new Date(announcement.send_at).toLocaleString() : 'now'}\n              </div>\n              <p>{announcement.body}</p>\n              <div className=\"text-xs text-muted-foreground\">\n                Delivered {announcement.sent_count || 0} • Bounced {announcement.bounced_count || 0}\n              </div>\n            </div>\n          ))}\n          {announcementsQuery.data?.announcements?.length === 0 && (\n            <p className=\"text-muted-foreground\">No announcements yet.</p>\n          )}\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n"],"names":["ROLE_OPTIONS","fetchJson","url","opts","response","text","normalizeCsv","value","item","AdminNotifications","toast","useToast","channel","setChannel","useState","title","setTitle","body","setBody","sendAt","setSendAt","userIds","setUserIds","schoolIds","setSchoolIds","selectedRoles","setSelectedRoles","headersQuery","useQuery","token","nhost","announcementsQuery","API_BASE_URL","metricsQuery","tenantSettingsQuery","notificationSettings","useMemo","_b","_a","toggleRole","prev","next","createMutation","useMutation","payload","error","settingsMutation","nextSettings","current","metrics","jsxs","jsx","Card","CardHeader","CardTitle","CardContent","Label","Switch","checked","_c","_d","_e","Input","event","Select","SelectTrigger","SelectValue","SelectContent","SelectItem","Textarea","role","Checkbox","Button","_f","announcement","_h","_g"],"mappings":"idAcA,MAAMA,GAAe,CACnB,CAAE,MAAO,SAAU,MAAO,SAAA,EAC1B,CAAE,MAAO,UAAW,MAAO,UAAA,EAC3B,CAAE,MAAO,eAAgB,MAAO,eAAA,EAChC,CAAE,MAAO,iBAAkB,MAAO,iBAAA,EAClC,CAAE,MAAO,eAAgB,MAAO,eAAA,CAClC,EAEA,eAAeC,EAAUC,EAAKC,EAAO,GAAI,CACvC,MAAMC,EAAW,MAAM,MAAMF,EAAKC,CAAI,EACtC,GAAI,CAACC,EAAS,GAAI,CAChB,MAAMC,EAAO,MAAMD,EAAS,KAAA,EAC5B,MAAM,IAAI,MAAMC,GAAQ,gBAAgB,CAC1C,CACA,OAAOD,EAAS,KAAA,CAClB,CAEA,SAASE,EAAaC,EAAO,CAC3B,OAAOA,EACJ,MAAM,GAAG,EACT,IAAKC,GAASA,EAAK,KAAA,CAAM,EACzB,OAAO,OAAO,CACnB,CAEA,SAAwBC,IAAqB,qBAC3C,KAAM,CAAE,MAAAC,CAAA,EAAUC,EAAA,EACZ,CAACC,EAASC,CAAU,EAAIC,EAAAA,SAAS,OAAO,EACxC,CAACC,EAAOC,CAAQ,EAAIF,EAAAA,SAAS,EAAE,EAC/B,CAACG,EAAMC,CAAO,EAAIJ,EAAAA,SAAS,EAAE,EAC7B,CAACK,EAAQC,CAAS,EAAIN,EAAAA,SAAS,EAAE,EACjC,CAACO,EAASC,CAAU,EAAIR,EAAAA,SAAS,EAAE,EACnC,CAACS,EAAWC,CAAY,EAAIV,EAAAA,SAAS,EAAE,EACvC,CAACW,EAAeC,CAAgB,EAAIZ,EAAAA,SAAS,IAAI,IAAI,CAAC,SAAU,SAAS,CAAC,CAAC,EAE3Ea,EAAeC,EAAS,CAC5B,SAAU,CAAC,sBAAsB,EACjC,QAAS,SAAY,CACnB,MAAMC,EAAQ,MAAMC,EAAM,KAAK,eAAA,EAC/B,MAAO,CACL,eAAgB,mBAChB,GAAID,EAAQ,CAAE,cAAe,UAAUA,CAAK,IAAO,CAAA,CAAC,CAExD,CAAA,CACD,EAEKE,EAAqBH,EAAS,CAClC,SAAU,CAAC,qBAAqB,EAChC,QAAS,SAAY3B,EAAU,GAAG+B,CAAY,qCAAsC,CAAE,QAASL,EAAa,IAAA,CAAM,CAAA,CACnH,EAEKM,EAAeL,EAAS,CAC5B,SAAU,CAAC,6BAA8BhB,CAAO,EAChD,QAAS,SACPX,EAAU,GAAG+B,CAAY,wCAAwCpB,CAAO,GAAI,CAAE,QAASe,EAAa,IAAA,CAAM,CAAA,CAC7G,EAEKO,EAAsBN,EAAS,CACnC,SAAU,CAAC,6BAA6B,EACxC,QAAS,SAAY3B,EAAU,GAAG+B,CAAY,oBAAqB,CAAE,QAASL,EAAa,IAAA,CAAM,CAAA,CAClG,EAEKQ,EAAuBC,EAAAA,QAAQ,IAAM,SAEzC,SADiBC,GAAAC,EAAAJ,EAAoB,OAApB,YAAAI,EAA0B,WAA1B,YAAAD,EAAoC,WAAY,CAAA,GACjD,eAAiB,CAAA,CACnC,EAAG,CAACH,EAAoB,IAAI,CAAC,EAEvBK,EAAchC,GAAU,CAC5BmB,EAAkBc,GAAS,CACzB,MAAMC,EAAO,IAAI,IAAID,CAAI,EACzB,OAAIC,EAAK,IAAIlC,CAAK,EAChBkC,EAAK,OAAOlC,CAAK,EAEjBkC,EAAK,IAAIlC,CAAK,EAETkC,CACT,CAAC,CACH,EAEMC,EAAiBC,EAAY,CACjC,WAAY,SAAY,CACtB,MAAMC,EAAU,CACd,QAAAhC,EACA,MAAAG,EACA,KAAAE,EACA,QAASE,EAAS,IAAI,KAAKA,CAAM,EAAE,cAAgB,KACnD,QAAS,CACP,MAAO,MAAM,KAAKM,CAAa,EAC/B,SAAUnB,EAAae,CAAO,EAC9B,WAAYf,EAAaiB,CAAS,CAAA,CACpC,EAEF,OAAOtB,EAAU,GAAG+B,CAAY,qCAAsC,CACpE,OAAQ,OACR,QAASL,EAAa,KACtB,KAAM,KAAK,UAAUiB,CAAO,CAAA,CAC7B,CACH,EACA,UAAW,IAAM,CACflC,EAAM,CACJ,MAAO,sBACP,YAAa,iDAAA,CACd,EACDM,EAAS,EAAE,EACXE,EAAQ,EAAE,EACVE,EAAU,EAAE,EACZW,EAAmB,QAAA,CACrB,EACA,QAAUc,GAAU,CAClBnC,EAAM,CACJ,QAAS,cACT,MAAO,iBACP,YAAamC,aAAiB,MAAQA,EAAM,QAAU,gCAAA,CACvD,CACH,CAAA,CACD,EAEKC,EAAmBH,EAAY,CACnC,WAAY,MAAOI,GAAiB,OAClC,MAAMC,IAAUV,EAAAJ,EAAoB,OAApB,YAAAI,EAA0B,WAAY,CAAA,EACtD,OAAOrC,EAAU,GAAG+B,CAAY,oBAAqB,CACnD,OAAQ,MACR,QAASL,EAAa,KACtB,KAAM,KAAK,UAAU,CACnB,SAAUqB,EAAQ,UAAY,CAAA,EAC9B,SAAU,CACR,GAAIA,EAAQ,UAAY,CAAA,EACxB,cAAeD,CAAA,CACjB,CACD,CAAA,CACF,CACH,EACA,UAAW,IAAM,CACfrC,EAAM,CACJ,MAAO,gCACP,YAAa,yCAAA,CACd,EACDwB,EAAoB,QAAA,CACtB,EACA,QAAUW,GAAU,CAClBnC,EAAM,CACJ,QAAS,cACT,MAAO,cACP,YAAamC,aAAiB,MAAQA,EAAM,QAAU,4BAAA,CACvD,CACH,CAAA,CACD,EAEKI,IAAUX,EAAAL,EAAa,OAAb,YAAAK,EAAmB,UAAW,CAAA,EAE9C,OACEY,EAAAA,KAAC,MAAA,CAAI,UAAU,gBACb,SAAA,CAAAA,OAAC,MAAA,CACC,SAAA,CAAAC,EAAAA,IAAC,KAAA,CAAG,UAAU,yBAAyB,SAAA,gBAAa,EACpDA,EAAAA,IAAC,IAAA,CAAE,UAAU,gCAAgC,SAAA,kFAAA,CAE7C,CAAA,EACF,SAECC,EAAA,CACC,SAAA,CAAAD,MAACE,EAAA,CACC,SAAAF,EAAAA,IAACG,EAAA,CAAU,SAAA,yBAAA,CAAuB,EACpC,QACCC,EAAA,CAAY,UAAU,oBACrB,SAAAL,EAAAA,KAAC,MAAA,CAAI,UAAU,4BACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,YACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,oCACb,SAAA,CAAAC,EAAAA,IAACK,EAAA,CAAM,QAAQ,aAAa,SAAA,gBAAa,EACzCL,EAAAA,IAACM,EAAA,CACC,GAAG,aACH,UAASpB,EAAAF,EAAqB,QAArB,YAAAE,EAA4B,OAAQ,OAC7C,gBAAkBqB,GAChBZ,EAAiB,OAAO,CACtB,GAAGX,EACH,MAAO,CAAE,GAAGA,EAAqB,MAAO,IAAKuB,EAAU,OAAS,MAAA,CAAO,CACxE,CAAA,CAAA,CAEL,EACF,EACAR,EAAAA,KAAC,MAAA,CAAI,UAAU,oCACb,SAAA,CAAAC,EAAAA,IAACK,EAAA,CAAM,QAAQ,cAAc,SAAA,iBAAc,EAC3CL,EAAAA,IAACM,EAAA,CACC,GAAG,cACH,UAASE,EAAAxB,EAAqB,QAArB,YAAAwB,EAA4B,QAAS,OAC9C,gBAAkBD,GAChBZ,EAAiB,OAAO,CACtB,GAAGX,EACH,MAAO,CAAE,GAAGA,EAAqB,MAAO,KAAMuB,EAAU,OAAS,MAAA,CAAO,CACzE,CAAA,CAAA,CAEL,EACF,EACAR,EAAAA,KAAC,MAAA,CAAI,UAAU,oCACb,SAAA,CAAAC,EAAAA,IAACK,EAAA,CAAM,QAAQ,eAAe,SAAA,kBAAe,EAC7CL,EAAAA,IAACM,EAAA,CACC,GAAG,eACH,UAASG,EAAAzB,EAAqB,QAArB,YAAAyB,EAA4B,SAAU,OAC/C,gBAAkBF,GAChBZ,EAAiB,OAAO,CACtB,GAAGX,EACH,MAAO,CAAE,GAAGA,EAAqB,MAAO,MAAOuB,EAAU,OAAS,MAAA,CAAO,CAC1E,CAAA,CAAA,CAEL,CAAA,CACF,CAAA,EACF,EACAR,EAAAA,KAAC,MAAA,CAAI,UAAU,YACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,oCACb,SAAA,CAAAC,EAAAA,IAACK,EAAA,CAAM,QAAQ,aAAa,SAAA,qBAAkB,EAC9CL,EAAAA,IAACM,EAAA,CACC,GAAG,aACH,UAASI,EAAA1B,EAAqB,MAArB,YAAA0B,EAA0B,UAAW,GAC9C,gBAAkBH,GAChBZ,EAAiB,OAAO,CACtB,GAAGX,EACH,IAAK,CAAE,GAAGA,EAAqB,IAAK,OAAQuB,CAAA,CAAQ,CACrD,CAAA,CAAA,CAEL,EACF,EACAP,EAAAA,IAAC,IAAA,CAAE,UAAU,gCAAgC,SAAA,kFAAA,CAE7C,CAAA,CAAA,CACF,CAAA,CAAA,CACF,CAAA,CACF,CAAA,EACF,SAECC,EAAA,CACC,SAAA,CAAAD,MAACE,EAAA,CACC,SAAAF,EAAAA,IAACG,EAAA,CAAU,SAAA,uBAAA,CAAqB,EAClC,EACAJ,EAAAA,KAACK,EAAA,CAAY,UAAU,YACrB,SAAA,CAAAL,EAAAA,KAAC,MAAA,CAAI,UAAU,4BACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,YACb,SAAA,CAAAC,EAAAA,IAACK,EAAA,CAAM,QAAQ,qBAAqB,SAAA,QAAK,EACzCL,EAAAA,IAACW,EAAA,CACC,GAAG,qBACH,MAAO/C,EACP,SAAWgD,GAAU/C,EAAS+C,EAAM,OAAO,KAAK,EAChD,YAAY,kBAAA,CAAA,CACd,EACF,EACAb,EAAAA,KAAC,MAAA,CAAI,UAAU,YACb,SAAA,CAAAC,EAAAA,IAACK,GAAM,SAAA,SAAA,CAAO,EACdN,EAAAA,KAACc,GAAA,CAAO,MAAOpD,EAAS,cAAeC,EACrC,SAAA,CAAAsC,MAACc,GAAA,CACC,SAAAd,EAAAA,IAACe,GAAA,CAAY,YAAY,iBAAiB,EAC5C,SACCC,GAAA,CACC,SAAA,CAAAhB,EAAAA,IAACiB,EAAA,CAAW,MAAM,QAAQ,SAAA,QAAK,EAC/BjB,EAAAA,IAACiB,EAAA,CAAW,MAAM,MAAM,SAAA,MAAG,EAC3BjB,EAAAA,IAACiB,EAAA,CAAW,MAAM,OAAO,SAAA,MAAA,CAAI,CAAA,CAAA,CAC/B,CAAA,CAAA,CACF,CAAA,CAAA,CACF,CAAA,EACF,EAEAlB,EAAAA,KAAC,MAAA,CAAI,UAAU,YACb,SAAA,CAAAC,EAAAA,IAACK,EAAA,CAAM,QAAQ,oBAAoB,SAAA,UAAO,EAC1CL,EAAAA,IAACkB,EAAA,CACC,GAAG,oBACH,MAAOpD,EACP,SAAW8C,GAAU7C,EAAQ6C,EAAM,OAAO,KAAK,EAC/C,KAAM,EACN,YAAY,wCAAA,CAAA,CACd,EACF,EAEAb,EAAAA,KAAC,MAAA,CAAI,UAAU,4BACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,YACb,SAAA,CAAAC,EAAAA,IAACK,EAAA,CAAM,QAAQ,sBAAsB,SAAA,sBAAmB,EACxDL,EAAAA,IAACW,EAAA,CACC,GAAG,sBACH,KAAK,iBACL,MAAO3C,EACP,SAAW4C,GAAU3C,EAAU2C,EAAM,OAAO,KAAK,CAAA,CAAA,CACnD,EACF,EACAb,EAAAA,KAAC,MAAA,CAAI,UAAU,YACb,SAAA,CAAAC,EAAAA,IAACK,EAAA,CAAM,QAAQ,sBAAsB,SAAA,wBAAqB,EAC1DL,EAAAA,IAACW,EAAA,CACC,GAAG,sBACH,MAAOvC,EACP,SAAWwC,GAAUvC,EAAauC,EAAM,OAAO,KAAK,EACpD,YAAY,YAAA,CAAA,CACd,CAAA,CACF,CAAA,EACF,EAEAb,EAAAA,KAAC,MAAA,CAAI,UAAU,YACb,SAAA,CAAAC,EAAAA,IAACK,GAAM,SAAA,cAAA,CAAY,EACnBL,EAAAA,IAAC,MAAA,CAAI,UAAU,2CACZ,SAAAnD,GAAa,IAAKsE,GACjBpB,EAAAA,KAAC,QAAA,CAAuB,UAAU,kCAChC,SAAA,CAAAC,EAAAA,IAACoB,GAAA,CACC,QAAS9C,EAAc,IAAI6C,EAAK,KAAK,EACrC,gBAAiB,IAAM/B,EAAW+B,EAAK,KAAK,CAAA,CAAA,EAE7CA,EAAK,KAAA,GALIA,EAAK,KAMjB,CACD,CAAA,CACH,CAAA,EACF,EAEApB,EAAAA,KAAC,MAAA,CAAI,UAAU,YACb,SAAA,CAAAC,EAAAA,IAACK,EAAA,CAAM,QAAQ,qBAAqB,SAAA,+BAA4B,EAChEL,EAAAA,IAACkB,EAAA,CACC,GAAG,qBACH,MAAOhD,EACP,SAAW0C,GAAUzC,EAAWyC,EAAM,OAAO,KAAK,EAClD,KAAM,EACN,YAAY,YAAA,CAAA,CACd,EACF,EAEAZ,EAAAA,IAACqB,EAAA,CAAO,QAAS,IAAM9B,EAAe,SAAU,SAAUA,EAAe,UAAW,SAAA,oBAAA,CAEpF,CAAA,CAAA,CACF,CAAA,EACF,SAECU,EAAA,CACC,SAAA,CAAAD,MAACE,EAAA,CACC,SAAAF,EAAAA,IAACG,EAAA,CAAU,SAAA,wBAAA,CAAsB,EACnC,EACAJ,EAAAA,KAACK,EAAA,CAAY,UAAU,oCACrB,SAAA,CAAAL,OAAC,MAAA,CACC,SAAA,CAAAC,EAAAA,IAAC,MAAA,CAAI,UAAU,wBAAwB,SAAA,YAAS,QAC/C,MAAA,CAAI,UAAU,wBAAyB,SAAAF,EAAQ,WAAa,CAAA,CAAE,CAAA,EACjE,SACC,MAAA,CACC,SAAA,CAAAE,EAAAA,IAAC,MAAA,CAAI,UAAU,wBAAwB,SAAA,UAAO,QAC7C,MAAA,CAAI,UAAU,wBAAyB,SAAAF,EAAQ,SAAW,CAAA,CAAE,CAAA,EAC/D,SACC,MAAA,CACC,SAAA,CAAAE,EAAAA,IAAC,MAAA,CAAI,UAAU,wBAAwB,SAAA,SAAM,QAC5C,MAAA,CAAI,UAAU,wBAAyB,SAAAF,EAAQ,QAAU,CAAA,CAAE,CAAA,EAC9D,SACC,MAAA,CACC,SAAA,CAAAE,EAAAA,IAAC,MAAA,CAAI,UAAU,wBAAwB,SAAA,UAAO,QAC7C,MAAA,CAAI,UAAU,wBAAyB,SAAAF,EAAQ,SAAW,CAAA,CAAE,CAAA,CAAA,CAC/D,CAAA,CAAA,CACF,CAAA,EACF,SAECG,EAAA,CACC,SAAA,CAAAD,MAACE,EAAA,CACC,SAAAF,EAAAA,IAACG,EAAA,CAAU,SAAA,sBAAA,CAAoB,EACjC,EACAJ,EAAAA,KAACK,EAAA,CAAY,UAAU,oBACnB,SAAA,IAAAkB,EAAA1C,EAAmB,OAAnB,YAAA0C,EAAyB,gBAAiB,CAAA,GAAI,IAAKC,GACnDxB,EAAAA,KAAC,MAAA,CAA0B,UAAU,kCACnC,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,oCACb,SAAA,CAAAC,MAAC,MAAA,CAAI,UAAU,gBAAiB,SAAAuB,EAAa,OAAS,wBAAwB,EAC9EvB,EAAAA,IAAC,MAAA,CAAI,UAAU,0CAA2C,WAAa,MAAA,CAAO,CAAA,EAChF,EACAD,EAAAA,KAAC,MAAA,CAAI,UAAU,gCACZ,SAAA,CAAAwB,EAAa,QAAQ,gBAAcA,EAAa,QAAU,IAAI,KAAKA,EAAa,OAAO,EAAE,iBAAmB,KAAA,EAC/G,EACAvB,EAAAA,IAAC,IAAA,CAAG,SAAAuB,EAAa,IAAA,CAAK,EACtBxB,EAAAA,KAAC,MAAA,CAAI,UAAU,gCAAgC,SAAA,CAAA,aAClCwB,EAAa,YAAc,EAAE,cAAYA,EAAa,eAAiB,CAAA,CAAA,CACpF,CAAA,GAXQA,EAAa,EAYvB,CACD,IACAC,GAAAC,EAAA7C,EAAmB,OAAnB,YAAA6C,EAAyB,gBAAzB,YAAAD,EAAwC,UAAW,GAClDxB,EAAAA,IAAC,IAAA,CAAE,UAAU,wBAAwB,SAAA,uBAAA,CAAqB,CAAA,CAAA,CAE9D,CAAA,CAAA,CACF,CAAA,EACF,CAEJ"}
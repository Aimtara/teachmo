{"version":3,"file":"SchoolDirectory-BRLS4GVB.js","sources":["../../src/pages/SchoolDirectory.jsx"],"sourcesContent":["import { useEffect, useState } from 'react';\nimport { useUserData } from '@nhost/react';\nimport { MessagingAPI } from '@/api/adapters';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Label } from '@/components/ui/label';\n\nexport default function SchoolDirectory() {\n  const user = useUserData();\n  const [schoolId, setSchoolId] = useState('');\n  const [targetUserId, setTargetUserId] = useState('');\n  const [note, setNote] = useState('');\n  const [status, setStatus] = useState('');\n  const [isSubmitting, setIsSubmitting] = useState(false);\n\n  useEffect(() => {\n    const derivedSchoolId = String(user?.metadata?.school_id ?? user?.metadata?.schoolId ?? '').trim();\n    if (derivedSchoolId) setSchoolId(derivedSchoolId);\n  }, [user]);\n\n  const submitRequest = async (event) => {\n    event.preventDefault();\n    if (!schoolId || !targetUserId) return;\n    setIsSubmitting(true);\n    setStatus('');\n    try {\n      const response = await MessagingAPI.requestMessagingAccess({ schoolId, targetUserId, note: note || undefined });\n      setStatus(response?.ok ? 'Request sent for approval.' : 'Unable to send request.');\n      if (response?.ok) setNote('');\n    } catch (error) {\n      console.error(error);\n      setStatus(error?.message ?? 'Failed to send request');\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  return (\n    <div className=\"p-6 space-y-4\">\n      <h1 className=\"text-2xl font-semibold text-gray-900\">School Directory</h1>\n      <p className=\"text-sm text-gray-600\">Request permission to message a teacher or staff member directly from the directory.</p>\n\n      <div className=\"rounded-lg border border-gray-200 bg-white p-4 shadow-sm\">\n        <form onSubmit={submitRequest} className=\"space-y-3\">\n          <div className=\"grid gap-3 md:grid-cols-2\">\n            <div className=\"space-y-1\">\n              <Label htmlFor=\"directory-school\">School ID</Label>\n              <Input\n                id=\"directory-school\"\n                value={schoolId}\n                onChange={(event) => setSchoolId(event.target.value)}\n                placeholder=\"School ID\"\n                required\n              />\n            </div>\n            <div className=\"space-y-1\">\n              <Label htmlFor=\"directory-target\">Teacher or staff user ID</Label>\n              <Input\n                id=\"directory-target\"\n                value={targetUserId}\n                onChange={(event) => setTargetUserId(event.target.value)}\n                placeholder=\"Target user ID\"\n                required\n              />\n            </div>\n          </div>\n\n          <div className=\"space-y-1\">\n            <Label htmlFor=\"directory-note\">Optional note</Label>\n            <Textarea\n              id=\"directory-note\"\n              value={note}\n              onChange={(event) => setNote(event.target.value)}\n              placeholder=\"Share context for your request\"\n              rows={3}\n            />\n          </div>\n\n          <div className=\"flex items-center gap-3\">\n            <Button type=\"submit\" disabled={isSubmitting}>\n              {isSubmitting ? 'Submittingâ€¦' : 'Request to message'}\n            </Button>\n            {status && <p className=\"text-sm text-gray-700\">{status}</p>}\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n}\n"],"names":["SchoolDirectory","user","useUserData","schoolId","setSchoolId","useState","targetUserId","setTargetUserId","note","setNote","status","setStatus","isSubmitting","setIsSubmitting","useEffect","derivedSchoolId","_a","_b","submitRequest","event","response","MessagingAPI.requestMessagingAccess","error","jsxs","jsx","Label","Input","Textarea","Button"],"mappings":"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"}
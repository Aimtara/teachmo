{"version":3,"file":"AdminSystemHealth-Beizoea-.js","sources":["../../node_modules/lucide-react/dist/esm/icons/circle-check.js","../../node_modules/lucide-react/dist/esm/icons/server.js","../../src/pages/AdminSystemHealth.jsx"],"sourcesContent":["/**\n * @license lucide-react v0.475.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"10\", key: \"1mglay\" }],\n  [\"path\", { d: \"m9 12 2 2 4-4\", key: \"dzmm74\" }]\n];\nconst CircleCheck = createLucideIcon(\"CircleCheck\", __iconNode);\n\nexport { __iconNode, CircleCheck as default };\n//# sourceMappingURL=circle-check.js.map\n","/**\n * @license lucide-react v0.475.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"rect\", { width: \"20\", height: \"8\", x: \"2\", y: \"2\", rx: \"2\", ry: \"2\", key: \"ngkwjq\" }],\n  [\"rect\", { width: \"20\", height: \"8\", x: \"2\", y: \"14\", rx: \"2\", ry: \"2\", key: \"iecqi9\" }],\n  [\"line\", { x1: \"6\", x2: \"6.01\", y1: \"6\", y2: \"6\", key: \"16zg32\" }],\n  [\"line\", { x1: \"6\", x2: \"6.01\", y1: \"18\", y2: \"18\", key: \"nzw8ys\" }]\n];\nconst Server = createLucideIcon(\"Server\", __iconNode);\n\nexport { __iconNode, Server as default };\n//# sourceMappingURL=server.js.map\n","import { useQuery } from '@tanstack/react-query';\nimport { CheckCircle2, AlertTriangle, Server } from 'lucide-react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { API_BASE_URL } from '@/config/api';\nimport { useTenant } from '@/contexts/TenantContext';\nimport { nhost } from '@/lib/nhostClient';\n\nexport default function AdminSystemHealth() {\n  const tenant = useTenant();\n\n  const headersQuery = useQuery({\n    queryKey: ['system-health-headers', tenant.organizationId, tenant.schoolId],\n    queryFn: async () => {\n      const token = await nhost.auth.getAccessToken();\n      const headers = {\n        'Content-Type': 'application/json',\n      };\n      if (token) headers.Authorization = `Bearer ${token}`;\n      if (tenant.organizationId) headers['x-teachmo-org-id'] = tenant.organizationId;\n      if (tenant.schoolId) headers['x-teachmo-school-id'] = tenant.schoolId;\n      return headers;\n    },\n    enabled: !tenant.loading,\n  });\n\n  const healthQuery = useQuery({\n    queryKey: ['system-health', headersQuery.data],\n    enabled: Boolean(headersQuery.data),\n    queryFn: async () => {\n      const response = await fetch(`${API_BASE_URL}/admin/system/health`, { headers: headersQuery.data });\n      if (!response.ok) throw new Error('Failed to load system health');\n      return response.json();\n    },\n  });\n\n  const services = healthQuery.data?.services || [];\n  const dependencies = healthQuery.data?.dependencies || [];\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <header>\n        <h1 className=\"text-3xl font-semibold\">System health</h1>\n        <p className=\"text-gray-600\">Live service status and dependency checks.</p>\n      </header>\n\n      <section className=\"grid gap-4 md:grid-cols-2 xl:grid-cols-3\">\n        {services.map((service) => (\n          <Card key={service.name}>\n            <CardHeader className=\"flex flex-row items-center justify-between\">\n              <CardTitle className=\"text-base font-medium\">{service.name}</CardTitle>\n              {service.status === 'ok' ? (\n                <CheckCircle2 className=\"h-4 w-4 text-emerald-500\" />\n              ) : (\n                <AlertTriangle className=\"h-4 w-4 text-amber-500\" />\n              )}\n            </CardHeader>\n            <CardContent className=\"text-sm text-gray-600\">\n              Status: <span className=\"font-medium text-gray-900\">{service.status}</span>\n            </CardContent>\n          </Card>\n        ))}\n      </section>\n\n      <section>\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <Server className=\"h-4 w-4 text-slate-500\" />\n              Dependencies\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-3\">\n            {dependencies.map((dep) => (\n              <div key={dep.name} className=\"flex items-center justify-between border rounded-md p-3\">\n                <div>\n                  <div className=\"font-medium\">{dep.name}</div>\n                  <div className=\"text-sm text-gray-500\">\n                    Pending: {dep.pending ?? 0} Â· Dead: {dep.dead ?? 0}\n                  </div>\n                </div>\n                <span className={`text-sm font-medium ${dep.status === 'ok' ? 'text-emerald-600' : 'text-amber-600'}`}>\n                  {dep.status}\n                </span>\n              </div>\n            ))}\n          </CardContent>\n        </Card>\n      </section>\n    </div>\n  );\n}\n"],"names":["__iconNode","CircleCheck","createLucideIcon","Server","AdminSystemHealth","tenant","useTenant","headersQuery","useQuery","token","nhost","headers","healthQuery","response","API_BASE_URL","services","_a","dependencies","_b","jsxs","jsx","service","Card","CardHeader","CardTitle","CheckCircle2","AlertTriangle","CardContent","dep"],"mappings":"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","x_google_ignoreList":[0,1]}
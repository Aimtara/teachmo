{"version":3,"file":"AdminMessagingBlocklist-D_67H-WC.js","sources":["../../src/pages/AdminMessagingBlocklist.jsx"],"sourcesContent":["import { useEffect, useState } from 'react';\nimport { MessagingModerationAPI } from '@/api/adapters';\n\nexport default function AdminMessagingBlocklist() {\n  const [blocks, setBlocks] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState('');\n  const [lifting, setLifting] = useState({});\n\n  const loadBlocks = async () => {\n    setLoading(true);\n    try {\n      const list = await MessagingModerationAPI.listBlocks();\n      setBlocks(Array.isArray(list) ? list : []);\n      setError('');\n    } catch (err) {\n      console.error(err);\n      setError(err?.message ?? 'Failed to load blocklist');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    loadBlocks();\n  }, []);\n\n  const lift = async (blockId) => {\n    if (!blockId) return;\n    setLifting((prev) => ({ ...prev, [blockId]: true }));\n    try {\n      await MessagingModerationAPI.liftBlock({ blockId });\n      await loadBlocks();\n    } catch (err) {\n      console.error(err);\n      setError(err?.message ?? 'Unable to lift block');\n    } finally {\n      setLifting((prev) => ({ ...prev, [blockId]: false }));\n    }\n  };\n\n  return (\n    <div className=\"p-6 space-y-4\">\n      <div className=\"flex flex-col gap-3 md:flex-row md:items-center md:justify-between\">\n        <div>\n          <p className=\"text-sm text-gray-500\">Messaging moderation</p>\n          <h1 className=\"text-3xl font-semibold text-gray-900\">Messaging Blocklist</h1>\n          <p className=\"text-sm text-gray-600\">See who is blocked from messaging within your school.</p>\n        </div>\n\n        <button\n          type=\"button\"\n          onClick={loadBlocks}\n          className=\"rounded-lg border border-gray-200 bg-white px-3 py-2 text-sm font-medium text-gray-800 shadow-sm hover:bg-gray-50\"\n        >\n          Refresh\n        </button>\n      </div>\n\n      {error && (\n        <div className=\"rounded-lg border border-red-100 bg-red-50 p-4 text-sm text-red-700\" role=\"alert\">\n          {error}\n        </div>\n      )}\n\n      {loading ? (\n        <p className=\"text-gray-600\">Loading blocklistâ€¦</p>\n      ) : blocks.length === 0 ? (\n        <div className=\"rounded-lg border border-gray-100 bg-white p-6 shadow-sm\">\n          <p className=\"font-semibold text-gray-900\">No blocked users</p>\n          <p className=\"text-sm text-gray-600\">No active messaging blocks for your school.</p>\n        </div>\n      ) : (\n        <div className=\"overflow-x-auto rounded-lg border border-gray-100 bg-white shadow-sm\">\n          <table className=\"min-w-full divide-y divide-gray-100\">\n            <thead className=\"bg-gray-50\">\n              <tr>\n                <th className=\"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wide text-gray-600\">User</th>\n                <th className=\"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wide text-gray-600\">Status</th>\n                <th className=\"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wide text-gray-600\">Reason</th>\n                <th className=\"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wide text-gray-600\">Actions</th>\n              </tr>\n            </thead>\n            <tbody className=\"divide-y divide-gray-100\">\n              {blocks.map((block) => (\n                <tr key={block.id}>\n                  <td className=\"px-4 py-3 text-sm text-gray-800\">{block.blocked_user_id}</td>\n                  <td className=\"px-4 py-3 text-sm text-gray-800 capitalize\">{block.status}</td>\n                  <td className=\"px-4 py-3 text-sm text-gray-800\">{block.reason || 'Not provided'}</td>\n                  <td className=\"px-4 py-3 text-sm text-gray-800\">\n                    <button\n                      type=\"button\"\n                      disabled={lifting[block.id] || block.status === 'lifted'}\n                      onClick={() => lift(block.id)}\n                      className=\"rounded border border-emerald-200 bg-emerald-50 px-3 py-1 text-xs font-semibold text-emerald-800 hover:bg-emerald-100 disabled:opacity-60\"\n                    >\n                      {block.status === 'lifted' ? 'Lifted' : 'Lift block'}\n                    </button>\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":["AdminMessagingBlocklist","blocks","setBlocks","useState","loading","setLoading","error","setError","lifting","setLifting","loadBlocks","list","MessagingModerationAPI.listBlocks","err","useEffect","lift","blockId","prev","MessagingModerationAPI.liftBlock","jsxs","jsx","block"],"mappings":"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"}
{"version":3,"file":"useAuth-DO66-fgk.js","sources":["../../src/components/hooks/useAuth.jsx"],"sourcesContent":["import { useMemo } from \"react\";\nimport { useAuthenticationStatus, useUserData } from \"@nhost/react\";\nimport { useUserRole } from \"@/hooks/useUserRole\";\n\nexport function useAuth() {\n  // G3 Gate: E2E Auth Bypass\n  // Allows smoke tests to run against localhost without hitting real Nhost.\n  const isE2EBypass = import.meta.env.VITE_E2E_BYPASS_AUTH === 'true';\n\n  if (isE2EBypass) {\n    // Read mock session injected by Playwright\n    let mockUser = null;\n    try {\n      const stored = window.localStorage.getItem('e2e_mock_user');\n      if (stored) mockUser = JSON.parse(stored);\n    } catch (e) {\n      /* ignore */\n    }\n\n    return {\n      user: mockUser,\n      activeRole: mockUser?.role || null,\n      isAuthenticated: !!mockUser,\n      loading: false,\n      refetchUser: async () => {}\n    };\n  }\n\n  const { isAuthenticated, isLoading } = useAuthenticationStatus();\n  const userData = useUserData();\n  const role = useUserRole();\n\n  const user = useMemo(() => {\n    if (!userData) return null;\n    return {\n      ...userData,\n      role,\n      preferred_active_role: userData?.metadata?.preferred_active_role || role,\n      full_name:\n        userData?.displayName ||\n        userData?.metadata?.full_name ||\n        userData?.email\n    };\n  }, [userData, role]);\n\n  return {\n    user,\n    activeRole: user?.preferred_active_role || user?.role || null,\n    isAuthenticated,\n    loading: isLoading,\n    refetchUser: async () => {}\n  };\n}\n\nexport default useAuth;\n"],"names":["useAuth","isAuthenticated","isLoading","useAuthenticationStatus","userData","useUserData","role","useUserRole","user","useMemo","_a","_b"],"mappings":"6DAIO,SAASA,GAAU,CAwBxB,KAAM,CAAE,gBAAAC,EAAiB,UAAAC,CAAA,EAAcC,EAAA,EACjCC,EAAWC,EAAA,EACXC,EAAOC,EAAA,EAEPC,EAAOC,EAAAA,QAAQ,IAAM,SACzB,OAAKL,EACE,CACL,GAAGA,EACH,KAAAE,EACA,wBAAuBI,EAAAN,GAAA,YAAAA,EAAU,WAAV,YAAAM,EAAoB,wBAAyBJ,EACpE,WACEF,GAAA,YAAAA,EAAU,gBACVO,EAAAP,GAAA,YAAAA,EAAU,WAAV,YAAAO,EAAoB,aACpBP,GAAA,YAAAA,EAAU,MAAA,EARQ,IAUxB,EAAG,CAACA,EAAUE,CAAI,CAAC,EAEnB,MAAO,CACL,KAAAE,EACA,YAAYA,GAAA,YAAAA,EAAM,yBAAyBA,GAAA,YAAAA,EAAM,OAAQ,KACzD,gBAAAP,EACA,QAASC,EACT,YAAa,SAAY,CAAC,CAAA,CAE9B"}
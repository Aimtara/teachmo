{"version":3,"file":"PartnerTraining-BW-SkWL2.js","sources":["../../src/api/partner/client.js","../../src/pages/PartnerTraining.jsx"],"sourcesContent":["import { getApiBaseUrl } from '@/config/api';\nimport { nhost } from '@/lib/nhostClient';\n\nexport async function partnerRequest(path, options = {}, tenant) {\n  const token = await nhost.auth.getAccessToken();\n  const headers = { 'content-type': 'application/json', ...(options.headers || {}) };\n  if (token) headers.authorization = `Bearer ${token}`;\n  if (tenant?.organizationId) headers['x-teachmo-org-id'] = tenant.organizationId;\n  if (tenant?.schoolId) headers['x-teachmo-school-id'] = String(tenant.schoolId);\n\n  const res = await fetch(`${getApiBaseUrl()}${path}`, { ...options, headers });\n  if (!res.ok) throw new Error(`HTTP ${res.status}`);\n  if (options.method === 'HEAD') return {};\n  return res.json();\n}\n","import { useEffect, useState } from 'react';\nimport { useTenant } from '@/contexts/TenantContext';\nimport { partnerRequest } from '@/api/partner/client';\n\nexport default function PartnerTraining() {\n  const tenant = useTenant();\n  const [courses, setCourses] = useState([]);\n  const [enrollments, setEnrollments] = useState([]);\n\n  const load = async () => {\n    if (!tenant.organizationId) return;\n    const [cs, ens] = await Promise.all([\n      partnerRequest('/courses', { method: 'GET' }, tenant),\n      partnerRequest('/courses/enrollments/me', { method: 'GET' }, tenant)\n    ]);\n    setCourses(cs);\n    setEnrollments(ens);\n  };\n\n  useEffect(() => { load(); }, [tenant.organizationId]);\n\n  const enroll = async (courseId) => {\n    await partnerRequest(`/courses/${courseId}/enroll`, { method: 'POST' }, tenant);\n    load();\n  };\n\n  const complete = async (courseId, moduleId) => {\n    await partnerRequest(`/courses/${courseId}/modules/${moduleId}/complete`, { method: 'POST' }, tenant);\n    load();\n  };\n\n  const enrollmentMap = Object.fromEntries(enrollments.map((e) => [e.courseId, e]));\n\n  return (\n    <div>\n      <h1>Training Courses</h1>\n      {courses.map((c) => {\n        const enrollment = enrollmentMap[c.id];\n        const completed = enrollment ? enrollment.completedModules.length : 0;\n        return (\n          <div key={c.id} style={{ border: '1px solid #ccc', margin: '1rem', padding: '1rem' }}>\n            <h2>{c.title}</h2>\n            <p>{c.description}</p>\n            {!enrollment && <button onClick={() => enroll(c.id)}>Enroll</button>}\n            {enrollment && (\n              <div>\n                <p>Progress: {completed}/{c.modules.length}</p>\n                {c.modules.map((m) => (\n                  <div key={m.id}>\n                    {m.title}{' '}\n                    {!enrollment.completedModules.includes(m.id) && (\n                      <button onClick={() => complete(c.id, m.id)}>Complete</button>\n                    )}\n                  </div>\n                ))}\n              </div>\n            )}\n          </div>\n        );\n      })}\n    </div>\n  );\n}\n"],"names":["partnerRequest","path","options","tenant","token","nhost","headers","res","getApiBaseUrl","PartnerTraining","useTenant","courses","setCourses","useState","enrollments","setEnrollments","load","cs","ens","useEffect","enroll","courseId","complete","moduleId","enrollmentMap","jsx","c","enrollment","completed","jsxs","m"],"mappings":"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"}
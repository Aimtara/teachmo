import{G as m,r as w,j as e,C as A,i as T,k as _,o as C,B as f,e as y,n as S}from"./index-BPP-_OMN.js";import{u as q}from"./useMutation-CMiQkM4s.js";import{T as R,a as k,b as x,c as o,d as N,e as i}from"./table-C5y0xJGn.js";import{T as B}from"./textarea-Be6YKw6o.js";async function b(d,l={}){const t=await fetch(d,l);if(!t.ok){const r=await t.text();throw new Error(r||"Request failed")}return t.json()}function g(){var v;const d=m({queryKey:["ai-review-token"],queryFn:async()=>{const s=await S.auth.getAccessToken();return{"Content-Type":"application/json",...s?{Authorization:`Bearer ${s}`}:{}}}}),l=m({queryKey:["ai-review-queue"],enabled:!!d.data,queryFn:async()=>b(`${y}/admin/ai/review-queue`,{headers:d.data})}),t=q({mutationFn:async({id:s,status:u,reason:h,notes:a})=>b(`${y}/admin/ai/review-queue/${s}/decision`,{method:"POST",headers:d.data,body:JSON.stringify({status:u,reason:h,notes:a})}),onSuccess:()=>l.refetch()}),[r,j]=w.useState({}),p=((v=l.data)==null?void 0:v.queue)||[];return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"AI Review Queue"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Approve or reject AI-generated content that requires human moderation."})]}),e.jsxs(A,{children:[e.jsx(T,{children:e.jsx(_,{children:"Pending Reviews"})}),e.jsx(C,{children:e.jsxs(R,{children:[e.jsx(k,{children:e.jsxs(x,{children:[e.jsx(o,{children:"Created"}),e.jsx(o,{children:"Model"}),e.jsx(o,{children:"Risk"}),e.jsx(o,{children:"Reason"}),e.jsx(o,{children:"Decision details"}),e.jsx(o,{children:"Actions"})]})}),e.jsx(N,{children:p.length===0?e.jsx(x,{children:e.jsx(i,{colSpan:6,className:"text-sm text-muted-foreground",children:"No items awaiting review."})}):p.map(s=>{var u,h;return e.jsxs(x,{children:[e.jsx(i,{children:s.created_at?new Date(s.created_at).toLocaleString():"—"}),e.jsx(i,{children:s.model??"—"}),e.jsx(i,{children:s.safety_risk_score??"—"}),e.jsx(i,{children:s.reason??"—"}),e.jsx(i,{children:e.jsxs("div",{className:"space-y-2 min-w-[220px]",children:[e.jsx("label",{className:"block text-xs font-medium text-muted-foreground",htmlFor:`reason-${s.id}`,children:"Decision reason"}),e.jsxs("select",{id:`reason-${s.id}`,value:((u=r[s.id])==null?void 0:u.reason)??"",onChange:a=>{const n=a.target.value;j(c=>({...c,[s.id]:{...c[s.id]||{},reason:n}}))},className:"w-full rounded-md border border-input bg-background px-2 py-1 text-sm",children:[e.jsx("option",{value:"",children:"Select reason"}),e.jsx("option",{value:"accurate",children:"Accurate"}),e.jsx("option",{value:"inaccurate",children:"Inaccurate"}),e.jsx("option",{value:"bias",children:"Bias"}),e.jsx("option",{value:"sensitive",children:"Sensitive content"}),e.jsx("option",{value:"other",children:"Other"})]}),e.jsx(B,{value:((h=r[s.id])==null?void 0:h.notes)??"",onChange:a=>{const n=a.target.value;j(c=>({...c,[s.id]:{...c[s.id]||{},notes:n}}))},placeholder:"Add notes for this decision",className:"min-h-[80px]"})]})}),e.jsxs(i,{className:"flex gap-2",children:[e.jsx(f,{variant:"secondary",size:"sm",onClick:()=>{var a,n;return t.mutate({id:s.id,status:"approved",reason:((a=r[s.id])==null?void 0:a.reason)??"",notes:((n=r[s.id])==null?void 0:n.notes)??""})},disabled:t.isPending,children:"Approve"}),e.jsx(f,{variant:"destructive",size:"sm",onClick:()=>{var a,n;return t.mutate({id:s.id,status:"rejected",reason:((a=r[s.id])==null?void 0:a.reason)??"",notes:((n=r[s.id])==null?void 0:n.notes)??""})},disabled:t.isPending,children:"Reject"})]})]},s.id)})})]})})]})]})}const D=Object.freeze(Object.defineProperty({__proto__:null,default:g},Symbol.toStringTag,{value:"Module"})),z=Object.freeze(Object.defineProperty({__proto__:null,default:g},Symbol.toStringTag,{value:"Module"}));export{D as A,z as a};
//# sourceMappingURL=AdminAIReviewQueue-DQBD0AoS.js.map
